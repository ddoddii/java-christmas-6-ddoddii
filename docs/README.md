![christmas-promotion](https://github.com/ddoddii/ddoddii.github.io/assets/95014836/805242ec-5d3f-4c02-81c4-9e1a1be80705)
![Static Badge](https://img.shields.io/badge/java-17-blue?color=green)

- Author : [엄소은](https://github.com/ddoddii)

🎅🏻 **우테코 식당의 크리스마스 프로모션을 소개합니다** 🎅🏻

- 이번 프로모션에서는 중복된 할인과 증정을 허용합니다.
- 올해 12월에 지난 5년 중 최고의 판매 금액을 달성하는 것이 목표입니다.
- 12월 이벤트 참여 고객의 5%가 내년 1월 새해 이벤트에 재참여 하는 것이 목표입니다.

## 목차

1. [🎄프로모션 소개](#프로모션-소개)
2. [🧐예상 시나리오](#-예상-시나리오)
3. [🎯기능 구현 목록](#-기능-구현-목록)
4. [🧭프로그램 설계](#-프로그램-설계)
5. [🧠고민한 지점](#-고민한-지점)
---

## 🎄프로모션 소개

### 🍭 메뉴

**<애피타이저>**  
양송이수프(6,000), 타파스(5,500), 시저샐러드(8,000)

**<메인>**  
티본스테이크(55,000), 바비큐립(54,000), 해산물파스타(35,000), 크리스마스파스타(25,000)

**<디저트>**  
초코케이크(15,000), 아이스크림(5,000)

**<음료>**  
제로콜라(3,000), 레드와인(60,000), 샴페인(25,000)

### 📅 할인 달력

<img width="600" alt="image" src="https://github.com/ddoddii/ddoddii.github.io/assets/95014836/2fd14cd4-136e-4d13-989c-942966d33d27">

### 📍 할인 이벤트 정리

**<크리스마스 D-Day 할인 : 12/1 ~ 12/25>**

- 1,000원으로 시작하여 크리스마스가 다가올수록 날마다 할인 금액이 100원씩 증가
- 총주문 금액에서 해당 금액만큼 할인

**<기타 할인 : 12/1 ~ 12/31>**

- 평일할인 : 디저트메뉴 (초코케이크, 아이스크림) 1개당 2023원 할인
- 주말할인 : 메인메뉴(티본스테이크, 바비큐립, 해산물파스타, 크리스마스파스타) 1개당 2023원 할인
- 특별할인 : 총 주문에서 1000원 할인

**<증정이벤트 : 12/1 ~ 12/31>**

- 증정이벤트 : 할인 전 총주문 금액이 120,000원 이상일 때 샴페인 1개 증정

### 🏅 혜택 금액에 따른 12월 이벤트 배지 부여

- 총 혜택 금액에 따라 이벤트 배지를 부여합니다.
    - 5,000원 이상 : 별
    - 10,000원 이상 : 트리
    - 20,000원 이상 : 산타

### ❗️이벤트 주의 사항

- 총 주문 금액 <font color="#ff0000">10,000원 이상</font> 부터 이벤트가 적용됩니다.
- 음료만 주문 시, 주문할 수 없습니다.
- 메뉴는 한 번에 최대 <font color="#ff0000">20개</font>까지만 주문 할 수 있습니다.

## 🧐 예상 시나리오

<details>
<summary>[시나리오1]</summary>
<div markdown="1">       

- 방문 날짜 : 3일
- 주문 메뉴 : 티본스테이크-1,바비큐립-1,초코케이크-2,제로콜라-1
- 할인 전 총주문 금액 : 55,000 + 54,000 + 15,000 * 2 + 3,000 = 142,000
- 증정 내역 : 샴페인 1개
- 혜택 내역
    - 크리스마스 할인 : 1000 + (3-1) * 2 = 1,200원
    - 특별 할인 : 1000원
    - 평일 할인 : 디저트 메뉴(초코케이크) 2개 -> 2,023 * 2 = 4,046원
    - 증정 이벤트 : 25,000원
- 총혜택 금액 : (1,200 + 1,000 + 4,046 + 25,000) = 31,246원
- 할인 후 예상 결제 금액 : 할인 전 총주문 금액(142,000) - 총할인 금액(1200 + 1000 + 4046 = 6,246) = 135,574원
- 이벤트 배지 : 총혜택 금액(31,246원) >= 20,000 이므로 산타

</div>
</details>

<details>
<summary>[시나리오2]</summary>
<div markdown="1">       

- 방문 날짜 : ([Author](https://github.com/ddoddii) 의 생일인) 23일
- 주문 메뉴 : 양송이수프-2,크리스마스파스타-2,바비큐립-1,레드와인-1
- 할인 전 총주문 금액 : 6,000 * 2 + 25,000 * 2 + 54,000 + 60,000 = 176,000원
- 증정 내역 : 샴페인 1개
- 혜택 내역
    - 크리스마스 할인 : 1000 + (23-1) * 100 = 3,200원
    - 주말 할인 : 메인메뉴(크리스마스파스타 2개, 바비큐립 1개) -> 2,023 * 3 = 6,069원
    - 증정 이벤트 : 25,000원
- 총혜택 금액 : (3,200 + 6,069 + 25,000) = 34,269원
- 할인 후 예상 결제 금액 : 할인 전 총주문 금액(176,000) - 총할인 금액(3,200 + 6,069 = 9,269) = 166,731
- 이벤트 배지 : 총혜택 금액(34,269원) >= 20,000 이므로 산타

</div>
</details>

---

## 🎯 기능 구현 목록

### ✅ 기능

- [X] 방문 날짜를 입력받는 기능
    - [X] 안내 메세지를 출력한다.
    - [X] 방문날짜는 1이상 31 이하의 정수이다.
    - [X] 1이상 31이하의 숫자가 아닐 경우, "[ERROR] 유효하지 않은 날짜입니다. 다시 입력해 주세요." 라는 에러 메세지를 출력한다.
    - [X] 에러 메세지를 출력한 후, 재입력을 받는다.
    - [X] 방문 날짜가 주말인지 확인한다.
    - [X] 방문 날짜가 평일인지 확인한다.
    - [X] 방문 날짜가 크리스마스 이전인지 확인한다.
- [X] 주문할 메뉴와 개수를 입력 받는 기능
    - [X] 안내 메세지를 출력한다.
    - [X] {메뉴}-{수량} 형식으로 입력 받는다.
    - [X] 메뉴 형식이 위와 다른 경우, "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요." 라는 에러 메세지를 출력한다.
    - [X] 각 메뉴는 쉼표(,) 로 구분한다.
    - [X] 메뉴판에 없는 메뉴를 입력한 경우,  "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요." 라는 에러 메세지를 출력한다.
    - [X] 메뉴의 개수는 1 이상의 숫자만 입력받는다.
    - [X] 메뉴의 개수가 1 이상의 숫자가 아닐 경우 "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요." 라는 에러 메세지를 출력한다.
    - [X] 중복 메뉴를 입력한 경우(e.g. 시저샐러드-1,시저샐러드-1), "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요."라는 에러 메시지를 출력한다.
    - [X] 음료만 주문한 경우, "[ERROR] 음료만 주문할 수 없습니다. 다시 입력해 주세요." 라는 에러 메세지를 출력한다.
    - [X] 메뉴 수량의 합이 20 초과할 시, "[ERROR] 메뉴는 한 번에 최대 20개까지만 주문할 수 있습니다. 다시 입력해 주세요." 라는 에러 메세지를 출력한다.
    - [X] 위의 모든 에러 메세지는 출력 후, 재입력을 받는다.
- [X] "12월 %d일에 우테코 식당에서 받을 이벤트 혜택 미리 보기!" 메세지를 출력한다.
- [X] 주문된 메뉴를 출력하는 기능
    - [X] 주문 메뉴를 '{메뉴이름} {수량}개' 형식으로 출력한다.
- [X] 할인 전 총주문 금액을 계산하는 기능
    - [X] 총주문 금액은 각 메뉴 별로 메뉴 수량 * 메뉴 금액 을 더한 값이다.
    - [X] 총주문 금액을 출력한다.
- [X] 증정 이벤트를 출력하는 기능
    - [X] 할인 전 총주문 금액이 120,000 이상일 시 "샴페인 1개"를 출력한다.
    - [X] 할인 전 총주문 금액이 120,000 미만일 시 "없음" 을 출력한다.
- [X] 혜택 내역을 출력하는 기능
    - [X] 총주문 금액이 10,000 미만일 시 혜택을 적용하지 않는다.
    - [X] 크리스마스 디데이 할인
        - [X] 방문날짜가 25 이하인 경우에만 적용한다.
        - [X] 할인 금액은  (1000 + (방문 날짜 - 1) * 100 ) 이다.
    - [X] 주말 할인
        - [X] 방문 날짜가 (1,2,8,9,15,16,22,23,29,30) 에 포함되는 경우, 메인 메뉴(티본스테이크, 바비큐립, 해산물파스타, 크리스마스파스타) 수량 1개 당 2,023원 할인한다.
        - [X] e.g. 티본스테이크-2, 바비큐립-1 을 주문했으면, 총 2,023 * 3 = 6,069 원 할인한다.
        - [X] 평일 할인
            - [X] 방문 날짜가 (3,4,5,6,7,10,11,12,13,14,17,18,19,20,21,24,25,26,27,28,31) 에 포함되는 경우, 디저트 메뉴(초코케이크, 아이스크림) 1개당
              2,023원 할인한다.
            - [X] e.g. 초코케이크-2, 아이스크림-2, 바비큐립-1 을 주문했으면, 2,023 * 4 = 8,092 원 할인한다.
    - [X] 특별 할인
        - [X] 방문 날짜가 (3,10,17,24,31) 에 포함되는 경우, 총 주문에서 1,000원 할인한다.
    - [X] 증정 이벤트
        - [X] 할인 전 총주문 금액이 120,000원 이상일 시 샴페인을 증정한다.
        - [X] 할인 전 총주문 금액이 120,000원 이상일 시 "증정 이벤트 : -25,000원" 을 출력한다.
    - [X] 혜택 금액은 `-{금액}원` 형식으로 출력한다.
    - [X] 혜택 내역이 없을 시 "없음" 을 출력한다.
- [X] 총혜택 금액을 출력하는 기능
    - [X] 할인 전 총주문 금액이 120,000 미만일 시, (총 할인 금액) 을 출력한다.
    - [X] 할인 전 총주문 금액이 120,000 이상일 시, (샴페인 가격(25,000) + 총 할인 금액) 을 출력한다.
- [X] 할인 후 예상 결제 금액을 출력하는 기능
    - [X] (할인 전 총주문 금액 - 총 할인 금액) 을 계산하여 출력한다.
- [X] 12월 이벤트 배지 출력 기능
    - [X] 총혜택 금액에 따라 차등으로 출력한다.
        - [X] 총혜택 금액이 5,000원 이상 : 별
        - [X] 총혜택 금액이 10,000원 이상 : 트리
        - [X] 총혜택 금액이 20,000원 이상 : 산타
    - [X] 총 혜택 금액이 5,000원 미만일 시 "없음" 을 출력한다.

### ⚠️예외

- [X] 입력 형식 관련 예외
    - [X] 입력값이 {메뉴}-{수량} 형식이 아닐 때 발생하는 예외 : MenuFormatException
- [X] 날짜 관련 예외
    - [X] 날짜가 정수가 아닐 때 발생하는 예외 : DateNotIntegerException
    - [X] 날짜가 1이상 31이하가 아닐 때 발생하는 예외 : DateRangeException
- [X] 메뉴 관련 예외
    - [X] 메뉴판에 없는 메뉴일때 발생하는 예외 : MenuNotFoundException
    - [X] 메뉴 개수가 1이상이 아닐 때 발생하는 예외 : MenuCountZeroException
    - [X] 중복 메뉴를 입력한 경우 발생하는 예외 : DuplicateMenuException
    - [X] 음료만 주문한 경우 발생하는 예외 : OnlyDrinkException
    - [X] 메뉴 수량이 20개 초과 시 발생하는 예외 : MenuAmountOverLimitException

## 🧭 프로그램 설계

<img width="1223" alt="스크린샷 2023-11-15 오후 2 59 59" src="https://github.com/ddoddii/ddoddii.github.io/assets/95014836/55441551-0deb-40f0-af1f-74accfca6e0f">

## 🧠 고민한 지점

<details>
<summary>View가 Model 에 의존해도 될까?</summary>

- Controller 에서 View 에게 넘겨줄 때, 원시값을 줄 지 Model 값을 줄 지 고민이 되었다. 
- Model 값을 넘겨준다면 View 가 Model 에 의존하게 되고, Model 의 이름이 변경되거나 수정사항이 있을 때 View 의 코드도 바꿔야 하는 문제가 생길 수 있다.
- 원시값을 넘겨준다면 Controller 에서 코드 중복이 발생하는 문제가 생겼다. 
- 이번 프로그램 설계에서는 Model 값을 넘겨주는 것으로 했다. Controller 의 로직은 훨씬 간편해졌지만, 위의 문제 괜찮을 지는 조금 더 고민해보고 토론해봐야 할 지점이다. 

</details>

<details>
<summary>구체적인 전략 주입은 어디에서?</summary>

- 이번 우테코 프로모션에서, 가장 크게 변경될 수 있는 것이 이벤트별 할인 전략이라고 생각했다.
- 따라서 DiscountStrategy 와, BadgeStrategy 를 만들고, WootecoDiscountStrategy 와 WootecoBadgeStrategy 에서 할인 정책을 구체적으로 구현했다. 
- 이 전략을 실제로 활용해서 총 혜택 금액과 배지 등급을 계산하는 것은 PromotionService 이 하도록 했다. 
- 여기서 Controller 에서 구체적인 전략을 주입해줄지, Application 에서 구체적인 전략을 주입할 지 고민이 되었다. 
- 나의 결론은, input 값에 따라서 전략을 바꿀 상황이 생길 수 있기 때문에 Controller 에서 실제 전략을 주입해 주었다.
- 주입해주는 방법에는 Config 를 생성해서 주입하는 방법, Strategy Factory 를 생성하는 방법, Setter Injection 등 더 다양한 방법이 있을 것이라 생각한다. 그 중 어느 것이 최선의 방법이 될지는 조금 더 고민을 해봐야겠다.

</details>